
; PICBASIC PRO(TM) Compiler 3.0.7.4, (c) 1998, 2013 microEngineering Labs, Inc. All Rights Reserved. 
MPASMX_USED			EQU	1

#define	PBP_PATH	C:\PROGRAM FILES (X86)\PBP3\




        NOLIST
    ifdef PM_USED
        LIST
        "Error: PM does not support this device.  Use MPASM."
        NOLIST
    else
        LIST
        LIST p = 18F46K80, r = dec, w = -311, f = inhx32
        INCLUDE "P18F46K80.INC"	; MPASM  Header
        NOLIST
    endif
        LIST
GO_DONE        EQU  H'0001'     ;named GO_NOT_DONE in the MPASM header file
EEPROM_START   EQU	0F00000h
BLOCK_SIZE     EQU	64


    #define HPWM_OVERRIDE 1
PBP_HARDWAREDEF  macro
    #include PBP_PATH\HPWM_K80_1.HWLIB
  endm


    CONFIG  RETEN = ON            ; Ultra low-power regulator is Enabled (Controlled by SRETEN bit)
    CONFIG  INTOSCSEL = HIGH      ; LF-INTOSC in High-power mode during Sleep
    CONFIG  SOSCSEL = HIGH        ; High Power SOSC circuit selected
    CONFIG  XINST = OFF           ; Disabled
    CONFIG  FOSC = HS1            ; HS oscillator (Medium power, 4 MHz - 16 MHz)
    CONFIG  PLLCFG = ON           ; Enabled
    CONFIG  FCMEN = OFF           ; Disabled
    CONFIG  IESO = OFF            ; Disabled
    CONFIG  PWRTEN = OFF          ; Disabled
    CONFIG  BOREN = SBORDIS       ; Enabled in hardware, SBOREN disabled
    CONFIG  BORV = 3              ; 1.8V
    CONFIG  BORPWR = ZPBORMV      ; ZPBORMV instead of BORMV is selected
    CONFIG  WDTEN = SWDTDIS       ; WDT enabled in hardware; SWDTEN bit disabled
    CONFIG  WDTPS = 512           ; 1:512
    CONFIG  CANMX = PORTB         ; ECAN TX and RX pins are located on RB2 and RB3, respectively
    CONFIG  MSSPMSK = MSK7        ; 7 Bit address masking mode
    CONFIG  MCLRE = ON            ; MCLR Enabled, RE3 Disabled
    CONFIG  STVREN = ON           ; Enabled
    CONFIG  BBSIZ = BB2K          ; 2K word Boot Block size
    CONFIG  CP0 = OFF             ; Disabled
    CONFIG  CP1 = OFF             ; Disabled
    CONFIG  CP2 = OFF             ; Disabled
    CONFIG  CP3 = OFF             ; Disabled
    CONFIG  CPB = OFF             ; Disabled
    CONFIG  CPD = OFF             ; Disabled
    CONFIG  WRT0 = OFF            ; Disabled
    CONFIG  WRT1 = OFF            ; Disabled
    CONFIG  WRT2 = OFF            ; Disabled
    CONFIG  WRT3 = OFF            ; Disabled
    CONFIG  WRTC = OFF            ; Disabled
    CONFIG  WRTB = OFF            ; Disabled
    CONFIG  WRTD = OFF            ; Disabled
    CONFIG  EBTR0 = OFF           ; Disabled
    CONFIG  EBTR1 = OFF           ; Disabled
    CONFIG  EBTR2 = OFF           ; Disabled
    CONFIG  EBTR3 = OFF           ; Disabled
    CONFIG  EBTRB = OFF           ; Disabled



; Define statements.
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00610	DEFINE  ADC_CHANNELS 1
#define		ADC_CHANNELS		 1

RAM_START       		EQU	00000h
RAM_END         		EQU	00E40h
RAM_BANKS       		EQU	0000Fh
BANK0_START     		EQU	00060h
BANK0_END       		EQU	000FFh
BANK1_START     		EQU	00100h
BANK1_END       		EQU	001FFh
BANK2_START     		EQU	00200h
BANK2_END       		EQU	002FFh
BANK3_START     		EQU	00300h
BANK3_END       		EQU	003FFh
BANK4_START     		EQU	00400h
BANK4_END       		EQU	004FFh
BANK5_START     		EQU	00500h
BANK5_END       		EQU	005FFh
BANK6_START     		EQU	00600h
BANK6_END       		EQU	006FFh
BANK7_START     		EQU	00700h
BANK7_END       		EQU	007FFh
BANK8_START     		EQU	00800h
BANK8_END       		EQU	008FFh
BANK9_START     		EQU	00900h
BANK9_END       		EQU	009FFh
BANK10_START    		EQU	00A00h
BANK10_END      		EQU	00AFFh
BANK11_START    		EQU	00B00h
BANK11_END      		EQU	00BFFh
BANK12_START    		EQU	00C00h
BANK12_END      		EQU	00CFFh
BANK13_START    		EQU	00D00h
BANK13_END      		EQU	00DFFh
BANK14_START    		EQU	00E00h
BANK14_END      		EQU	00E40h
BANKA_START     		EQU	00000h
BANKA_END       		EQU	0005Fh

; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00028	A00000	FLAGS   VAR     BYTE BANKA SYSTEM       ' Static flags
FLAGS           		EQU	RAM_START + 000h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00027	A00001	GOP     VAR     BYTE BANKA SYSTEM       ' Gen Op Parameter
GOP             		EQU	RAM_START + 001h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00016	A00002	R4      VAR     WORD BANKA SYSTEM       ' System Register
R4              		EQU	RAM_START + 002h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00017	A00004	R5      VAR     WORD BANKA SYSTEM       ' System Register
R5              		EQU	RAM_START + 004h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00018	A00006	R6      VAR     WORD BANKA SYSTEM       ' System Register
R6              		EQU	RAM_START + 006h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00019	A00008	R7      VAR     WORD BANKA SYSTEM       ' System Register
R7              		EQU	RAM_START + 008h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00020	A0000A	R8      VAR     WORD BANKA SYSTEM       ' System Register
R8              		EQU	RAM_START + 00Ah
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00023	A0000C	RM1     VAR     BYTE BANKA SYSTEM       ' Pin 1 Mask
RM1             		EQU	RAM_START + 00Ch
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00026	A0000D	RM2     VAR     BYTE BANKA SYSTEM       ' Pin 2 Mask
RM2             		EQU	RAM_START + 00Dh
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00021	A0000E	RR1     VAR     BYTE BANKA SYSTEM       ' Pin 1 Register
RR1             		EQU	RAM_START + 00Eh
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00024	A0000F	RR2     VAR     BYTE BANKA SYSTEM       ' Pin 2 Register
RR2             		EQU	RAM_START + 00Fh
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00022	A00010	RS1     VAR     BYTE BANKA SYSTEM       ' Pin 1 Bank
RS1             		EQU	RAM_START + 010h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00025	A00011	RS2     VAR     BYTE BANKA SYSTEM       ' Pin 2 Bank
RS2             		EQU	RAM_START + 011h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00012	A00012	R0      VAR     LONG BANKA SYSTEM       ' System Register
R0              		EQU	RAM_START + 012h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00013	A00016	R1      VAR     LONG BANKA SYSTEM       ' System Register
R1              		EQU	RAM_START + 016h
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00014	A0001A	R2      VAR     LONG BANKA SYSTEM       ' System Register
R2              		EQU	RAM_START + 01Ah
; C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.RAM	00015	A0001E	R3      VAR     LONG BANKA SYSTEM       ' System Register
R3              		EQU	RAM_START + 01Eh
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00004	A00022	rtcAging			VAR	Byte			'Aging offset data
_rtcAging        		EQU	RAM_START + 022h
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00007	A00023	rtcControl			VAR	Byte			'control byte for RTC operation
_rtcControl      		EQU	RAM_START + 023h
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00014	A00024	rtcStatus			VAR	Byte			'status byte for RTC operation
_rtcStatus       		EQU	RAM_START + 024h
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00006	A00025	rtcTempLSB			VAR	Byte			'temperature (least significant byte)
_rtcTempLSB      		EQU	RAM_START + 025h
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00005	A00026	rtcTempMSB			VAR	Byte			'temperature (most significant byte)
_rtcTempMSB      		EQU	RAM_START + 026h
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00611	PORTL   VAR     PORTB
_PORTL           		EQU	 PORTB
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00612	PORTH   VAR     PORTC
_PORTH           		EQU	 PORTC
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00613	TRISL   VAR     TRISB
_TRISL           		EQU	 TRISB
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00614	TRISH   VAR     TRISC
_TRISH           		EQU	 TRISC
#define _rtcENOSC_       	_rtcControl??7
#define _rtcBBSQW        	_rtcControl??6
#define _rtcCONV         	_rtcControl??5
#define _rtcINTCN        	_rtcControl??2
#define _rtcA2IE         	_rtcControl??1
#define _rtcA1IE         	_rtcControl??0
#define _rtcOSF          	_rtcStatus??7
#define _rtcEN32kHz      	_rtcStatus??3
#define _rtcBSY          	_rtcStatus??2
#define _rtcA2F          	_rtcStatus??1
#define _rtcA1F          	_rtcStatus??0
#define _rtcControl??7   	_rtcControl, 007h
#define _rtcControl??6   	_rtcControl, 006h
#define _rtcControl??5   	_rtcControl, 005h
#define _rtcControl??2   	_rtcControl, 002h
#define _rtcControl??1   	_rtcControl, 001h
#define _rtcControl??0   	_rtcControl, 000h
#define _rtcStatus??7    	_rtcStatus, 007h
#define _rtcStatus??3    	_rtcStatus, 003h
#define _rtcStatus??2    	_rtcStatus, 002h
#define _rtcStatus??1    	_rtcStatus, 001h
#define _rtcStatus??0    	_rtcStatus, 000h

; Constants.
_rtcSecondsREG   		EQU	00000h
_rtcMinutesREG   		EQU	00001h
_rtcHoursREG     		EQU	00002h
_rtcDayREG       		EQU	00003h
_rtcDateREG      		EQU	00004h
_rtcMonthsREG    		EQU	00005h
_rtcYearsREG     		EQU	00006h
_rtcAlarm1SecsREG		EQU	00007h
_rtcAlarm1MinsREG		EQU	00008h
_rtcAlarm1HoursREG		EQU	00009h
_rtcAlarm1DaysREG		EQU	0000Ah
_rtcAlarm2MinsREG		EQU	0000Bh
_rtcAlarm2HoursREG		EQU	0000Ch
_rtcAlarm2DaysREG		EQU	0000Dh
_rtcControlREG   		EQU	0000Eh
_rtcStatusREG    		EQU	0000Fh
_rtcAgingREG     		EQU	00010h
_rtcTempMSBREG   		EQU	00011h
_rtcTempLSBREG   		EQU	00012h

; EEPROM data.


	INCLUDE	"RTC.MAC"
	INCLUDE	"C:\PROGRAM FILES (X86)\PBP3\PBPPI18L.LIB"


; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00036	Z00002	#HEADER
Z00002
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00063	Z00003	#CONFIG
Z00003
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00584	Z00004	BANKA   $0000, $005F
Z00004
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00585	Z00005	BANK0   $0060, $00FF
Z00005
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00586	Z00006	BANK1   $0100, $01FF
Z00006
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00587	Z00007	BANK2   $0200, $02FF
Z00007
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00588	Z00008	BANK3   $0300, $03FF
Z00008
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00589	Z00009	BANK4   $0400, $04FF
Z00009
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00590	Z0000A	BANK5   $0500, $05FF
Z0000A
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00591	Z0000B	BANK6   $0600, $06FF
Z0000B
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00592	Z0000C	BANK7   $0700, $07FF
Z0000C
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00593	Z0000D	BANK8   $0800, $08FF
Z0000D
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00594	Z0000E	BANK9   $0900, $09FF
Z0000E
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00595	Z0000F	BANK10  $0A00, $0AFF
Z0000F
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00596	Z00010	BANK11  $0B00, $0BFF
Z00010
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00597	Z00011	BANK12  $0C00, $0CFF
Z00011
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00598	Z00012	BANK13  $0D00, $0DFF
Z00012
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00599	Z00013	BANK14  $0E00, $0E40
Z00013
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00601	Z00014	'EEPROM  $F00000, $F003FF
Z00014
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00603	Z00015	    #MSG "LONG Variables enabled (PBPL used)"
Z00015
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00604	Z00016	    LIBRARY  "PBPPI18L"
Z00016

; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00605	Z00017	    INCLUDE "PBPPI18L.RAM"
Z00017
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00608	Z00018	    INCLUDE "PBPPIC18.RAM"
Z00018
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00609	Z00019	#ENDIF
Z00019
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00610	Z0001A	DEFINE  ADC_CHANNELS 1
Z0001A
; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F46K80.PBPINC	00618	Z0001B	#header
Z0001B

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00001	Z0001C	Disable Interrupt
Z0001C
	IDISABLE?	
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00021	Z0001D	rtcSecondsREG		CON		$00			; variable rtcAddress gets set to one of these for reading/writing	
Z0001D
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00022	Z0001E	rtcMinutesREG		CON		$01			; burst read/write is predominantly used for this application
Z0001E
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00023	Z0001F	rtcHoursREG			CON		$02
Z0001F
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00024	Z00020	rtcDayREG			CON		$03		
Z00020
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00025	Z00021	rtcDateREG			CON		$04
Z00021
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00026	Z00022	rtcMonthsREG		CON		$05		
Z00022
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00027	Z00023	rtcYearsREG			CON		$06
Z00023
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00028	Z00024	rtcAlarm1SecsREG	CON		$07
Z00024
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00029	Z00025	rtcAlarm1MinsREG	CON		$08
Z00025
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00030	Z00026	rtcAlarm1HoursREG	CON		$09
Z00026
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00031	Z00027	rtcAlarm1DaysREG	CON		$0A
Z00027
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00032	Z00028	rtcAlarm2MinsREG	CON		$0B
Z00028
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00033	Z00029	rtcAlarm2HoursREG	CON		$0C
Z00029
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00034	Z0002A	rtcAlarm2DaysREG	CON		$0D
Z0002A
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00035	Z0002B	rtcControlREG		CON		$0E
Z0002B
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00036	Z0002C	rtcStatusREG		CON		$0F
Z0002C
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00037	Z0002D	rtcAgingREG			CON		$10
Z0002D
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00038	Z0002E	rtcTempMSBREG		CON		$11
Z0002E
; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00039	Z0002F	rtcTempLSBREG		CON		$12
Z0002F

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00041	Z00030	goto	RTC_Done		'jump over subroutines so that they don't evaluate on startup
Z00030
	GOTO?L	_RTC_Done

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00047	Z00031	SetupRTC:	
Z00031

	LABEL?L	_SetupRTC	

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00048	Z00032		rtcControl 	=	$00	; enable osc, no square wave on battery, 1Hz on pin 3, no alarm1, no alarm2
Z00032
	MOVE?CB	000h, _rtcControl

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00049	Z00033		rtcStatus	=	%00001000 ; oscillator time now valid, yes 32kHz output, not busy, no alarm conditions
Z00033
	MOVE?CB	008h, _rtcStatus

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00050	Z00034		rtcAging	=	$00	; no aging oscillator correction when first set up
Z00034
	MOVE?CB	000h, _rtcAging

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00051	Z00035		I2Cwrite		I2Cdata,I2Cclk,rtcI2Caddress,rtcControlREG,[rtcControl,rtcStatus,rtcAging]
Z00035
	I2CDATA?C	000h
	I2CCLOCK?C	000h
	I2CWRITE?C	000h

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00052	Z00036		pause	10										
Z00036
	PAUSE?C	00Ah

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00053	Z00037	Return
Z00037
	RETURN?	

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00056	Z00038	UpdateRTC:						; BURST WRITE
Z00038

	LABEL?L	_UpdateRTC	

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00060	Z00039		I2Cwrite	I2Cdata,I2Cclk,rtcI2Caddress,rtcSecondsREG,[STR TimeBCD \TimeLength]
Z00039
	I2CDATA?C	000h
	I2CCLOCK?C	000h
	I2CWRITE?C	000h

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00061	Z0003A		pause 10
Z0003A
	PAUSE?C	00Ah

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00062	Z0003B	Return
Z0003B
	RETURN?	

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00065	Z0003C	ReadRTC:						; BURST READ
Z0003C

	LABEL?L	_ReadRTC	

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00066	Z0003D		I2Cread		I2Cdata,I2Cclk,rtcI2Caddress,rtcSecondsREG,[STR TimeBCD \TimeLength]
Z0003D
	I2CDATA?C	000h
	I2CCLOCK?C	000h
	I2CWRITE?C	000h

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00071	Z0003E	Return
Z0003E
	RETURN?	

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00074	Z0003F	RTC_Done:
Z0003F

	LABEL?L	_RTC_Done	

; C:\USERS\NFITCH\GOOGLE DRIVE\IMPERIAL\ELECTRONICS\CCM_0001_UNIPOLAR_STEPPER_MOTOR_CONTROLLER\REVA\FIRMWARE.X\INCLUDES\RTC.PBP	00076	Z00040	Enable Interrupt
Z00040
	IENABLE?	

	END
